name: Plugins - Trufflehog secrets scanning
description: Scans plugin zip files for secrets using Trufflehog.

inputs:
  folder:
    description: |
      Folder containing plugin zip files to scan.
      It will be scanned recursively.
    required: true

runs:
  using: composite
  steps:
    - name: Install Trufflehog
      shell: bash
      run: |
        curl -sSfL https://raw.githubusercontent.com/trufflesecurity/trufflehog/main/scripts/install.sh | sh

    - name: Run Trufflehog
      shell: bash
      run: ./bin/trufflehog filesystem "${{ inputs.folder }}" --fail --github-actions --debug
